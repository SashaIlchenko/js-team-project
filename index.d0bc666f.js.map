{"mappings":"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","sources":["src/index.js","src/js/auth.js","src/js/trending-movies.js"],"sourcesContent":["import './js/darktheme';\nimport './js/api-fetch';\nimport './js/render-cards';\nimport './js/modalMovie.js';\n\nimport './js/ls-data';\nimport './js/page-content-loader';\nimport './js/auth';\nimport './js/search-movies';\nimport './js/loader-spinner';\nimport './js/scroll-up-arrow';\nimport './js/trending-movies';\n\n","// *** AUTH MODULE (div into lesser functional chunks) *** //\n\nimport { isOnHomePage } from \"./page-content-loader\";\n\nimport { getStorageData, setStorageData, lskeys } from \"./ls-data\";\nconst { STORAGE_USERS, CRT_USER } = lskeys;\n\n\nconst refs = {\n\tsignUpForm: document.querySelector('.form-signup'),\n\tsignUpBtn: document.querySelector('.button--signup'),\n\tsignInForm: document.querySelector('.form-signin'),\n\tsignInBtn: document.querySelector('.button--signin'),\n\n\t// modal refs\n\tmodalOpenBtns: document.querySelectorAll('[data-modal-open]'),\n    modalCloseBtns: document.querySelectorAll('[data-modal-close]'),\n    overlay: document.querySelector('.js-overlay-modal'),\n};\n\n\n// *** Auth modal windows *** //\n\n// !!! remove fn wrapper when lib page contains auth modal windows !!!\n// check if page is home page \nif (isOnHomePage()) {\n\tdocument.addEventListener('DOMContentLoaded', handleAuth);\n}\n\n// function wrapping to avoid errors on pages with no auth modals\nfunction handleAuth() {\n\t// add listeners for modals open/close\n\trefs.modalOpenBtns.forEach(function (openBtn) {\n\t\topenBtn.addEventListener('click', openModal);\n\t});\n\n\trefs.modalCloseBtns.forEach(function (closeBtn) {\n\t\tcloseBtn.addEventListener('click', closeModal);\n\t});\n\n\n\t// add functions for handling opening/closing\n\tfunction openModal(e) {\n\t\t// prevent default click handling if button is a link\n\t\te.preventDefault();\n\n\t\tconst modalId = this.getAttribute('data-modal-open');\n\t\tconst modalElem = document.querySelector('.modal[data-modal=\"' + modalId + '\"]');\n\n\t\t// hotfix for swapping auth forms\n\t\tif (e.target.dataset.modalOpen === \"signup\" ||\n\t\t\te.target.dataset.modalOpen === \"login\") {\n\t\t\tcloseModal.call(this);\n\t\t}\n\n\t\tmodalElem.classList.add('active');\n\t\trefs.overlay.classList.add('active');\n\t}\n\n\tfunction closeModal(e) {\n\t\tconst parentModal = this.closest('.modal');\n\n\t\tif (parentModal) {\n\t\t\tparentModal.classList.remove('active');\n\t\t\trefs.overlay.classList.remove('active');\n\t\t}\n\t}\n\n\t// close on hitting Escape button\n\tdocument.body.addEventListener('keyup', (e) => {\n\t\tif (e.key === 'Escape') {\n\t\t\tdocument.querySelector('.modal.active').classList.remove('active');\n\t\t\tdocument.querySelector('.overlay').classList.remove('active');\n\t\t}\n\t});\n\n\trefs.overlay.addEventListener('click', function () {\n\t\tdocument.querySelector('.modal.active').classList.remove('active');\n\t\tthis.classList.remove('active');\n\t});\n\n\n\n\t// listeners moved from auth scripts \n\trefs.signInBtn.addEventListener('click', onLoginClick);\n\trefs.signUpBtn.addEventListener('click', onSignUpClick);\n\n};\n\n//endof handleAuth\n\n\n// *** //\n\n\n\n\n// *** Auth forms code *** //\n\nfunction onLoginClick(e) {\n\te.preventDefault();\n\t\n\tconst userLogin = refs.signInForm.elements[\"user-email\"].value;\n\tconst userPassword = refs.signInForm.elements[\"user-password\"].value;\n\t\n\tloginUser({userLogin, userPassword});\n}\n\n\nfunction onSignUpClick(e) {\n\te.preventDefault();\n\t\n\tconst userLogin = refs.signUpForm.elements[\"user-email\"].value;\n\tconst userPassword = refs.signUpForm.elements[\"user-password\"].value;\n\tconst userName = refs.signUpForm.elements[\"username\"].value;\n\n\tcreateUser({userLogin, userPassword, userName});\n\tloginUser({userLogin, userPassword});\n}\n\n// *** //\n\n\n\n// *** Auth scripts *** //\n\n// create user\n// ADD VALIDATION!!!\n\nfunction createUser(credentials) {\n\tconst {userName, userLogin, userPassword} = credentials;\n\n\tlet users = getStorageData(STORAGE_USERS);\n\n\tconst userData = {\n\t\tuserid: null,\n\t\tusername: userName,\n\t\tlogin: userLogin,\n\t\tpassword: userPassword,\n\t\tqueue: [],\n\t\twatched: [],\n\t}\n\t\n\t// check if any users\n\tif (!users) {\n\t\tuserData.userid = 1;\n\t\tusers = [userData];\n\t\tsetStorageData(STORAGE_USERS, users);\n\t\t// add notification (instead of console.log) and autologin redirect\n\t\talert(\"User created!\");\n\t\treturn;\n\t}\n\t\t\n\t// check if user already exists\n\tif (isExistingUser(userLogin)) {\n\t\talert(\"There is already a user with this email!\");\n\t\treturn;\n\t}\n\n\t// default behaviour if all checks failed\n\tconst userids = users.map(user => user[\"userid\"]);\n\tuserData.userid = Math.max(...userids) + 1;\n\tusers.push(userData);\n\tsetStorageData(STORAGE_USERS, users);\n\t// add notification and autologin redirect\n\talert(\"User created!\");\n}\n\n\n// login user\n\nfunction loginUser(credentials) {\n\tconst {userLogin, userPassword} = credentials;\n\t\n\tconst users = getStorageData(STORAGE_USERS);\n\n\tif (!users) {\n\t\talert(\"No users yet. Sign-up and become a user!\");\n\t\treturn;\n\t}\n\n\tif (isExistingUser(userLogin))  {\n\t\t// find existing user and check if passwords match\n\t\tconst user = users.find(user => user.login === userLogin);\n\n\t\t// check if passwords match\n\t\tif (user.password === userPassword) {\n\t\t\t// check if already logged in\n\t\t\tif (user.userid === getStorageData(CRT_USER)) {\n\t\t\t\talert(\"Already logged in!\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// set current user\n\t\t\tsetStorageData(CRT_USER, user.userid);\n\n\t\t\talert(\"Welcome!\");\n\t\t\t// close login window after successful login\n\t\t\tdocument.querySelector('.modal.active').firstElementChild.click();\n\t\t\treturn;\n\t\t} \n\t\t\n\t\talert(\"Password incorrect!\");\n\t} else {\n\t\talert(\"No user found with this email. Please check your login and password and try again.\");\n\t}\n}\n\n\n// check existing user util\n\nfunction isExistingUser(login) {\n\tconst users = getStorageData(STORAGE_USERS);\n\tconst logins = users.map(user => user[\"login\"]);\n\t\n\treturn (logins.includes(login));\n}\n\n// *** //\n","import { getTrendMovies } from './api-fetch';\nimport { createMarkupOfTrendingMovies, galleryList, onFooterFixed, onFooterNoFixed } from './render-cards';\nimport Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.min.css';\nimport '/src/sass/components/_pagination.scss';\nimport { onSpinnerDisabled, onSpinnerEnabled } from './loader-spinner';\n\nconst container = document.querySelector('.tui-pagination');\nconst options = {\n    totalItems: 1000,\n    itemsPerPage: 20,\n    visiblePages: 5,\n    page: 1,\n    centerAlign: false,\n    firstItemClassName: 'tui-first-child',\n    lastItemClassName: 'tui-last-child',\n};\n\nconst pagination = new Pagination(container, options);\n\npagination.on('afterMove', async function (eventData) {\n    var currentPage = eventData.page;\n    galleryList.innerHTML = '';\n    onFooterFixed();\n    onSpinnerEnabled();\n    const data = await getTrendMovies(currentPage);\n    try {\n        onSpinnerDisabled();\n        createMarkupOfTrendingMovies(data);\n        onFooterNoFixed();\n    } catch (err) {\n        console.log(err)\n    }\n});"],"names":["parcelRequire","$by4Ut","STORAGE_USERS","$8953c87b21bd174e$var$STORAGE_USERS","CRT_USER","$8953c87b21bd174e$var$CRT_USER","$2bfol","lskeys","$8953c87b21bd174e$var$refs","signUpForm","document","querySelector","signUpBtn","signInForm","signInBtn","modalOpenBtns","querySelectorAll","modalCloseBtns","overlay","$8953c87b21bd174e$var$onLoginClick","e","preventDefault","$8953c87b21bd174e$var$loginUser","elements","value","$8953c87b21bd174e$var$onSignUpClick","userLogin","userPassword","credentials","userName","users","getStorageData","userData","userid","username","login","password","queue","watched","setStorageData","alert","$8953c87b21bd174e$var$isExistingUser","userids","map","user","Math","max","push","$8953c87b21bd174e$var$createUser","find","firstElementChild","click","includes","isOnHomePage","addEventListener","openModal","modalId","this","getAttribute","modalElem","target","dataset","modalOpen","closeModal","call","classList","add","parentModal","closest","remove","forEach","openBtn","closeBtn","body","key","$hvDb2","$98dde6eb6bdada15$var$container","$parcel$interopDefault","$fb9GJ","totalItems","itemsPerPage","visiblePages","page","centerAlign","firstItemClassName","lastItemClassName","on","async","eventData","currentPage","$1Ea6K","galleryList","innerHTML","onFooterFixed","$6pIJ7","onSpinnerEnabled","data","getTrendMovies","onSpinnerDisabled","createMarkupOfTrendingMovies","onFooterNoFixed","err","console","log"],"version":3,"file":"index.d0bc666f.js.map"}